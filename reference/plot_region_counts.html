<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Regional Physician Counts by Specified Grouping — plot_region_counts • tyler</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Regional Physician Counts by Specified Grouping — plot_region_counts"><meta name="description" content="This function creates a choropleth map visualizing physician counts by region, with options for grouping states into custom regions. It handles merging state counts with regional data, calculating centroids for text labels, and generating plots using ggplot2. Logging is included to provide insights into the execution flow and data transformations."><meta property="og:description" content="This function creates a choropleth map visualizing physician counts by region, with options for grouping states into custom regions. It handles merging state counts with regional data, calculating centroids for text labels, and generating plots using ggplot2. Logging is included to provide insights into the execution flow and data transformations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tyler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Assign_Insurance_Assign_Scenarios.html">Sampling Spine Surgeons and Assigning Cases</a></li>
    <li><a class="dropdown-item" href="../articles/create_isochrones.html">Gathering Drive Time Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/geocode.html">Geocoding</a></li>
    <li><a class="dropdown-item" href="../articles/get_census_data.html">Getting Data from the US Census Bureau for Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/my-vignette.html">Searching the NPI Database Starting with Taxonomy Codes</a></li>
    <li><a class="dropdown-item" href="../articles/Poisson_Regression_and_Effects.html">Analyzing Wait Times for Appointments: Poisson Regression and Interaction Effects</a></li>
    <li><a class="dropdown-item" href="../articles/search_and_process_npi.html">Search and Process NPI Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/validate_and_remove_invalid_npi.html">Gather Physician Data Starting With NPI Numbers</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mufflyt/tyler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Regional Physician Counts by Specified Grouping</h1>
      <small class="dont-index">Source: <a href="https://github.com/mufflyt/tyler/blob/main/R/plot_region_counts.R" class="external-link"><code>R/plot_region_counts.R</code></a></small>
      <div class="d-none name"><code>plot_region_counts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates a choropleth map visualizing physician counts by region, with options for grouping states into custom regions. It handles merging state counts with regional data, calculating centroids for text labels, and generating plots using ggplot2. Logging is included to provide insights into the execution flow and data transformations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_region_counts</span><span class="op">(</span><span class="va">state_counts</span>, <span class="va">region_df</span>, <span class="va">region_col</span>, save_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-state-counts">state_counts<a class="anchor" aria-label="anchor" href="#arg-state-counts"></a></dt>
<dd><p>A dataframe containing state-level physician counts. Must have columns <code>state_code</code> (lowercase state names) and <code>total_available</code> (numerical counts).</p></dd>


<dt id="arg-region-df">region_df<a class="anchor" aria-label="anchor" href="#arg-region-df"></a></dt>
<dd><p>A dataframe mapping states to regions. Must include <code>State</code> (state names in lowercase) and a column for the region grouping.</p></dd>


<dt id="arg-region-col">region_col<a class="anchor" aria-label="anchor" href="#arg-region-col"></a></dt>
<dd><p>A string specifying the column in <code>region_df</code> to use for grouping states into regions (e.g., "Region").</p></dd>


<dt id="arg-save-path">save_path<a class="anchor" aria-label="anchor" href="#arg-save-path"></a></dt>
<dd><p>Optional. A string specifying the file path to save the plot as an image. If <code>NULL</code> (default), the plot is displayed onscreen but not saved.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object representing the choropleth map.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function merges <code>state_counts</code> and <code>region_df</code> by state name, aggregates physician counts by region, and maps these counts onto a choropleth. Labels representing the counts are added at region centroids.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Plot and save a map grouped by ENT_BOG regions</span></span></span>
<span class="r-in"><span><span class="va">ent_bog_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  State <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alabama"</span>, <span class="st">"alaska"</span>, <span class="st">"arizona"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ENT_BOG_Region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Region 4"</span>, <span class="st">"Region 9"</span>, <span class="st">"Region 9"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alabama"</span>, <span class="st">"alaska"</span>, <span class="st">"arizona"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  total_available <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_region_counts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_counts <span class="op">=</span> <span class="va">state_counts</span>,</span></span>
<span class="r-in"><span>  region_df <span class="op">=</span> <span class="va">ent_bog_regions</span>,</span></span>
<span class="r-in"><span>  region_col <span class="op">=</span> <span class="st">"ENT_BOG_Region"</span>,</span></span>
<span class="r-in"><span>  save_path <span class="op">=</span> <span class="st">"ent_bog_region_map.png"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Function `plot_region_counts` called with inputs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] state_counts dataframe with columns: state_code, total_available</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] region_df dataframe with columns: State, ENT_BOG_Region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Region column for grouping: ENT_BOG_Region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Save path specified: ent_bog_region_map.png</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Transforming state codes in `state_counts` and `region_df` to lowercase.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Merging `state_counts` with `region_df` based on the State and `ENT_BOG_Region` columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Completed merge and aggregation. Resulting `state_counts_with_regions` has 2 rows.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Retrieving US state map data and converting region names to lowercase.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ggplot2::map_data("state"):</span> The package "maps" is required for `map_data()`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Plot ACOG Districts without saving</span></span></span>
<span class="r-in"><span><span class="va">ACOG_Districts_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  State <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"california"</span>, <span class="st">"nevada"</span>, <span class="st">"utah"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ACOG_District <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"District IX"</span>, <span class="st">"District IX"</span>, <span class="st">"District VIII"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"california"</span>, <span class="st">"nevada"</span>, <span class="st">"utah"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  total_available <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">12</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_region_counts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_counts <span class="op">=</span> <span class="va">state_counts</span>,</span></span>
<span class="r-in"><span>  region_df <span class="op">=</span> <span class="va">ACOG_Districts_sf</span>,</span></span>
<span class="r-in"><span>  region_col <span class="op">=</span> <span class="st">"ACOG_District"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Function `plot_region_counts` called with inputs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] state_counts dataframe with columns: state_code, total_available</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] region_df dataframe with columns: State, ACOG_District</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Region column for grouping: ACOG_District</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] No save path specified; plot will only display on screen.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Transforming state codes in `state_counts` and `region_df` to lowercase.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Merging `state_counts` with `region_df` based on the State and `ACOG_District` columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Completed merge and aggregation. Resulting `state_counts_with_regions` has 2 rows.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Retrieving US state map data and converting region names to lowercase.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ggplot2::map_data("state"):</span> The package "maps" is required for `map_data()`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Plot custom regions and save output</span></span></span>
<span class="r-in"><span><span class="va">custom_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  State <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"texas"</span>, <span class="st">"new york"</span>, <span class="st">"florida"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Custom_Region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"South"</span>, <span class="st">"Northeast"</span>, <span class="st">"South"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"texas"</span>, <span class="st">"new york"</span>, <span class="st">"florida"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  total_available <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">17</span>, <span class="fl">13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_region_counts</span><span class="op">(</span></span></span>
<span class="r-in"><span>  state_counts <span class="op">=</span> <span class="va">state_counts</span>,</span></span>
<span class="r-in"><span>  region_df <span class="op">=</span> <span class="va">custom_regions</span>,</span></span>
<span class="r-in"><span>  region_col <span class="op">=</span> <span class="st">"Custom_Region"</span>,</span></span>
<span class="r-in"><span>  save_path <span class="op">=</span> <span class="st">"custom_region_map.png"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Function `plot_region_counts` called with inputs:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] state_counts dataframe with columns: state_code, total_available</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] region_df dataframe with columns: State, Custom_Region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Region column for grouping: Custom_Region</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Save path specified: custom_region_map.png</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Transforming state codes in `state_counts` and `region_df` to lowercase.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Merging `state_counts` with `region_df` based on the State and `Custom_Region` columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Completed merge and aggregation. Resulting `state_counts_with_regions` has 2 rows.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> INFO [2025-03-11 12:21:35] Retrieving US state map data and converting region names to lowercase.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in ggplot2::map_data("state"):</span> The package "maps" is required for `map_data()`.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tyler Muffly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

