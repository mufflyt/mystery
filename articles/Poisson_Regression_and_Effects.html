<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Wait Times for Appointments: Poisson Regression and Interaction Effects • tyler</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Wait Times for Appointments: Poisson Regression and Interaction Effects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tyler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Assign_Insurance_Assign_Scenarios.html">Sampling Spine Surgeons and Assigning Cases</a></li>
    <li><a class="dropdown-item" href="../articles/create_isochrones.html">Gathering Drive Time Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/geocode.html">Geocoding</a></li>
    <li><a class="dropdown-item" href="../articles/get_census_data.html">Getting Data from the US Census Bureau for Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/my-vignette.html">Searching the NPI Database Starting with Taxonomy Codes</a></li>
    <li><a class="dropdown-item" href="../articles/Poisson_Regression_and_Effects.html">Analyzing Wait Times for Appointments: Poisson Regression and Interaction Effects</a></li>
    <li><a class="dropdown-item" href="../articles/search_and_process_npi.html">Search and Process NPI Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/validate_and_remove_invalid_npi.html">Gather Physician Data Starting With NPI Numbers</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mufflyt/tyler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analyzing Wait Times for Appointments: Poisson Regression and Interaction Effects</h1>
                        <h4 data-toc-skip class="author">Tyler Muffly,
MD</h4>
            
            <h4 data-toc-skip class="date">2025-01-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mufflyt/tyler/blob/main/vignettes/Poisson_Regression_and_Effects.Rmd" class="external-link"><code>vignettes/Poisson_Regression_and_Effects.Rmd</code></a></small>
      <div class="d-none name"><code>Poisson_Regression_and_Effects.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In healthcare, understanding wait times for medical appointments is a
crucial factor in improving patient care. This vignette demonstrates how
to analyze waiting times for appointments using Poisson regression,
which is appropriate for count data, such as the number of business days
until a patient’s appointment. Specifically, we investigate how
insurance type and medical scenario influence waiting times and explore
interaction effects between these two variables. Additionally, we will
use Estimated Marginal Means (EMMs) to interpret the results, allowing
for clearer comparisons across groups.</p>
<div class="section level3">
<h3 id="data-preparation">1. Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>Before we begin the analysis, we need to prepare and load the data.
The data we’ll use contains the following columns:</p>
<p>The dataset contains the following columns:</p>
<ul>
<li>
<strong>Scenario</strong>: Different medical conditions (e.g.,
Tubo-Ovarian Abscess, Pregnancy after Tubal Ligation, UTI,
Vaginitis).</li>
<li>
<strong>Insurance</strong>: Patient insurance types (e.g., Medicaid,
Blue Cross/Blue Shield).</li>
<li>
<strong>Business Days Until Appointment</strong>: Number of days it
takes for patients to secure an appointment.</li>
<li>
<strong>NPI</strong>: National Provider Identifier, representing
healthcare providers (used as a random effect).</li>
</ul>
<div class="section level4">
<h4 id="simulating-example-data">Simulating Example Data<a class="anchor" aria-label="anchor" href="#simulating-example-data"></a>
</h4>
<p>We also simulate the data here for demonstration purposes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">##   object 'type_sum.accel' not found</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: Matrix</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rvlenth.github.io/emmeans/" class="external-link">emmeans</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Welcome to emmeans.</span></span>
<span><span class="co">## Caution: You lose important information if you filter this package's results.</span></span>
<span><span class="co">## See '? untidy'</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'tidyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:Matrix':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     expand, pack, unpack</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example data preparation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TOA"</span>, <span class="st">"Pregnancy after Tubal Ligation"</span>, <span class="st">"UTI"</span>, <span class="st">"Vaginitis"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>  insurance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Medicaid"</span>, <span class="st">"Blue Cross/Blue Shield"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>  business_days_until_appointment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">200</span>, lambda <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  NPI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here, we’ve simulated data where the outcome variable,
business_days_until_appointment, follows a Poisson distribution, a
suitable model for count data like this. The insurance column includes
two types of insurance, Medicaid and Blue Cross/Blue Shield, while the
scenario column includes different medical situations.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-a-poisson-regression-model">2. Fitting a Poisson Regression Model<a class="anchor" aria-label="anchor" href="#fitting-a-poisson-regression-model"></a>
</h2>
<div class="section level3">
<h3 id="fit-the-interaction-model">2.1 Fit the Interaction Model<a class="anchor" aria-label="anchor" href="#fit-the-interaction-model"></a>
</h3>
<p>To analyze the effect of insurance and scenario on waiting times, we
fit a Poisson regression model using the glmer function from the lme4
package. This model accounts for the interaction between insurance type
and scenario, as well as a random intercept for NPI (since different
healthcare providers might have different waiting times).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interaction_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">glmer</a></span><span class="op">(</span></span>
<span>  <span class="va">business_days_until_appointment</span> <span class="op">~</span> <span class="va">scenario</span> <span class="op">*</span> <span class="va">insurance</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">NPI</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <strong>Poisson regression model</strong> assumes that the count
data (waiting time in days) follows a Poisson distribution and allows us
to estimate the effects of the predictor variables
(<code>insurance</code> and <code>scenario</code>) on the outcome
(<code>business_days_until_appointment</code>). The glmer function
includes a random intercept for <code>NPI</code>, accounting for the
fact that healthcare providers may have systematically different wait
times.</p>
<p>The Poisson regression model assumes that the count data (waiting
time in days) follows a Poisson distribution and allows us to estimate
the effects of the predictor variables (insurance and scenario) on the
outcome (business_days_until_appointment). The glmer function includes a
random intercept for NPI, accounting for the fact that healthcare
providers may have systematically different wait times.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimated-marginal-means-emms">3. Estimated Marginal Means (EMMs)<a class="anchor" aria-label="anchor" href="#estimated-marginal-means-emms"></a>
</h2>
<div class="section level3">
<h3 id="extract-emms">3.1 Extract EMMs<a class="anchor" aria-label="anchor" href="#extract-emms"></a>
</h3>
<p>We now use the Estimated Marginal Means (EMMs) to obtain adjusted
estimates for waiting times. EMMs allow us to make comparisons between
levels of the predictor variables (e.g., insurance type), while
controlling for other factors in the model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interaction_result</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="fu">::</span><span class="fu"><a href="https://rvlenth.github.io/emmeans/reference/emmeans.html" class="external-link">emmeans</a></span><span class="op">(</span><span class="va">interaction_model</span>, <span class="op">~</span> <span class="va">scenario</span> <span class="op">*</span> <span class="va">insurance</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">interaction_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">interaction_result</span><span class="op">)</span></span></code></pre></div>
<p>The emmeans function computes estimated marginal means for each
combination of scenario and insurance type, providing us with adjusted
waiting times. These adjusted means account for other variables in the
model, helping us focus on the effect of insurance type on wait
times.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tyler Muffly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
