% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/results_section_plot_and_save_emmeans.R
\name{plot_and_save_emmeans}
\alias{plot_and_save_emmeans}
\title{Plot and Save Estimated Marginal Means (EMMs) with Error Handling}
\usage{
plot_and_save_emmeans(
  model_object,
  specs,
  variable_of_interest,
  color_by,
  output_dir = "Ari/Figures",
  y_min = NULL,
  y_max = NULL
)
}
\arguments{
\item{model_object}{A fitted model object from which EMMs are to be computed. This can be a generalized linear model (GLM), linear model, or other suitable models.}

\item{specs}{A character string or formula specifying the predictor variable(s) for which EMMs are to be computed. For example, this could be treatment groups, scenarios, or demographic variables.}

\item{variable_of_interest}{A character string specifying the variable to be plotted on the x-axis. Typically, this would be the same as the \code{specs} parameter.}

\item{color_by}{A character string specifying the variable used to color the points and error bars. This could be a categorical variable such as gender, insurance type, or academic affiliation.}

\item{output_dir}{A character string specifying the directory where the plot will be saved. Defaults to "Ari/Figures".}

\item{y_min}{Minimum value for the y-axis. Defaults to \code{NULL}, which means it will be calculated automatically from the data.}

\item{y_max}{Maximum value for the y-axis. Defaults to \code{NULL}, which means it will be calculated automatically from the data.}
}
\value{
A list containing the estimated marginal means data (\code{data}) and the ggplot object (\code{plot}).
}
\description{
This function computes the estimated marginal means (EMMs) from a model object, creates a plot of the EMMs with confidence intervals, and saves the plot to a specified directory. It includes robust error handling, detailed logging, and default behaviors that should work out of the box.
}
\details{
This function logs each data transformation, the inputs, the outputs, and where the output files are saved. It uses the \code{emmeans} package to compute EMMs and creates the plot using \code{ggplot2}. The function ensures logging of key steps to assist in debugging and auditing.
}
